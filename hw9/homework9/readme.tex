\documentclass[11pt]{article}
\usepackage[top=1cm, bottom=2cm, left=1cm, right=1cm]{geometry}
\usepackage{ctex}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{amsthm,amsmath,amssymb}
\usepackage[colorlinks=true,linkcolor=blue]{hyperref}
\usepackage{listings}
\usepackage{xcolor,xparse}
\usepackage{realboxes}
\usepackage{graphics}
\usepackage{graphicx}
\usepackage{mathrsfs}
\usepackage{wrapfig}
\usepackage{subfigure}
\usepackage{pifont}
\newcommand{\To}{\textbf{To} }
\definecolor{cmdbg}{rgb}{0.9,0.9,0.9}
\lstset{%
	basicstyle=\ttfamily,
	breaklines = true,
	backgroundcolor=\color{cmdbg},
}
\DeclareDocumentCommand{\ccmd}{v}{% å‚æ•° v è¡¨ç¤ºå·¥ä½œæ–¹æ³•ç±»ä¼¼äº \verb
    \Colorbox{cmdbg}{\csname lstinline\endcsname!#1!}%
}

\makeatletter
\newenvironment{breakablealgorithm}
  {% \begin{breakablealgorithm}
   \begin{center}
     \refstepcounter{algorithm}% New algorithm
     \hrule height.8pt depth0pt \kern2pt% \@fs@pre for \@fs@ruled
     \renewcommand{\caption}[2][\relax]{% Make a new \caption
       {\raggedright\textbf{\ALG@name~\thealgorithm} ##2\par}%
       \ifx\relax##1\relax % #1 is \relax
         \addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##2}%
       \else % #1 is not \relax
         \addcontentsline{loa}{algorithm}{\protect\numberline{\thealgorithm}##1}%
       \fi
       \kern2pt\hrule\kern2pt
     }
  }{% \end{breakablealgorithm}
     \kern2pt\hrule\relax% \@fs@post for \@fs@ruled
   \end{center}
  }
\makeatother

\author{è°¢æ˜€åŸ 22307110070}
\title{è®¡ç®—ç‰©ç†ä½œä¸š9}

\begin{document}
\maketitle




  \section{é¢˜ç›®1}
  \subsection{é¢˜ç›®æè¿°}
  
  The interior of a ğ‘‘-dimensional hypersphere of unit radius is defined by the condition 
  . Write a program that finds the volume of a hypersphere using a Monte Carlo method. Test your program for $d=2$ and $d=3$ and then calculate the volume for $d=4$ and $d=5$, compare your results with the exact results.
\subsection{ç¨‹åºæè¿°}
   åœ¨æœ¬ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•è®¡ç®—dç»´è¶…çƒä½“çš„ä½“ç§¯ï¼Œå¹¶è®¡ç®—äº†1-7ç»´çš„ä½“ç§¯ï¼Œå¹¶æ¯”è¾ƒäº†å…¶ä¸æ ‡å‡†å€¼çš„ç›¸å¯¹è¯¯å·®ã€‚å…¶ä¸­ç¨‹åºä½¿ç”¨çº¿æ€§åŒä½™ç®—æ³•ç”Ÿæˆå‡åŒ€åˆ†å¸ƒçš„ä¼ªéšæœºæ•°ã€‚

æœ¬ç¨‹åºæºæ–‡ä»¶ä¸ºsphere.pyï¼Œåœ¨ç»ˆç«¯è¿›å…¥å½“å‰ç›®å½•ï¼Œä½¿ç”¨å‘½ä»¤python -u sphere.pyè¿è¡Œæœ¬ç¨‹åºã€‚è¿è¡Œæ—¶è¯·ä¿è¯Pythonç¬¬ä¸‰æ–¹åº“Numpy,Matplotlibå·²å®‰è£…ã€‚ç¨‹åºå¼€å‘ç¯å¢ƒä¸ºPython3.12.3ï¼Œå¯åœ¨Python3.8ä»¥ä¸Šç‰ˆæœ¬ä¸­è¿è¡Œã€‚

\subsection{ä¼ªä»£ç }
\subsubsection*{ä¼ªéšæœºæ•°ç”Ÿæˆ ä¼ªä»£ç :}
\begin{breakablealgorithm}
  \caption{PRN}
  \begin{algorithmic}
    \Function{PRN}{$n,dim,rmin,rmax,seed$}
      \State \textbf{INPUT:} $n$ (number of rows), $dim$ (number of columns), $rmin$ (minimum range), $rmax$ (maximum range), $seed$ (initial seed)
      \State \textbf{OUTPUT:} $result$ (2D array of pseudo-random numbers)
      
      \State $m \gets 2^{31} - 1$,$a \gets 48271$,$b \gets 43$,$x \gets seed$
      \State $result \gets$ [] \Comment{Initialize empty list to store results}
      
      \For{$i \gets 0$ \To $n \cdot dim - 1$}
          \State $x \gets (a \cdot x + b) \% m$
          \State Append $rmin + (rmax - rmin) \cdot x / m$ to $result$
      \EndFor
  
      \State $result \gets$ Reshape(result, $n$, $dim$) \Comment{Convert the list to a 2D array}
      \State \Return $result$
    \EndFunction
  \end{algorithmic}
  \end{breakablealgorithm}
  
  \subsubsection*{è’™ç‰¹å¡æ´›ç§¯åˆ†ä¼ªä»£ç }
  \begin{breakablealgorithm}
    \caption{intMcN}
    \begin{algorithmic}
      \Function{intMcN}{$fn,r,point$}
        \State \textbf{INPUT:} $fn$ (function to integrate), $r$ (function to rescale), $point$ (sampling points)
        \State \textbf{OUTPUT:} $result$ (Monte Carlo integral value)
        
        \State $result \gets$ Mean\Big([$fn(p)/r(p)$ for $p$ in $point$]\Big) \Comment{Compute average over sampling points}
        
        \State \Return $result$
      \EndFunction
    \end{algorithmic}
    \end{breakablealgorithm}
    
  
  
  
  \subsection{è¾“å…¥è¾“å‡ºå®ä¾‹}

  å¯¹äºæœ¬ç¨‹åºï¼Œè¿è¡Œåä¼šç”Ÿæˆå›¾\ref{fig:prn}å’Œå›¾\ref{fig:v}ä¸º"PRN"å’Œ"VolumeDim.png"äºå½“å‰ç›®å½•ä¸‹,åˆ†åˆ«ä¸ºä¼ªéšæœºæ•°é‡‡æ ·å’Œä½“ç§¯è®¡ç®—ç»“æœå’Œç›¸å¯¹è¯¯å·®ï¼Œå¹¶åœ¨æ§åˆ¶å°æ‰“å°è®¡ç®—ç»“æœã€‚ç¨‹åºè¿è¡Œæˆªå›¾å¦‚å›¾\ref{fig:p1}æ‰€ç¤ºã€‚å¯ä»¥çœ‹åˆ°ï¼Œéšç€ç»´æ•°å¢åŠ ï¼Œè®¡ç®—ç»“æœçš„åå·®ä¹Ÿå¢åŠ ï¼Œè¿™æ˜¯ç”±äºé«˜ç»´ç©ºé—´çš„çƒä½“ç§¯å æ€»é‡‡æ ·ä½“ç§¯çš„æ¯”ä¾‹æ›´å°ï¼Œé‡‡æ ·æ›´å›°éš¾ã€‚
  \begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\linewidth]{photo/PRN}
    \caption{PRN é‡‡æ ·åˆ†å¸ƒ(a)dimension=1(b)dimension=2}
    \label{fig:prn}
  \end{figure}

  \begin{figure}[ht]
    \centering
    \includegraphics[width=1.0\linewidth]{photo/VolumeDim.png}
    \caption{(a)ä¸åŒç»´åº¦ä¸‹çƒä½“ç§¯è®¡ç®—ç»“æœ(b)ä¸æ ‡å‡†å€¼ç›¸å¯¹è¯¯å·®}
    \label{fig:v}
  \end{figure}

  \begin{figure}
    \centering
    \includegraphics[width=0.6\linewidth]{photo/figp1.png}
    \caption{é¢˜ç›®1ç¨‹åºè¿è¡Œæˆªå›¾}
    \label{fig:p1}
  \end{figure}

  \section{é¢˜ç›®2}

  Write a MC code for a 3D Face-Centered Cubic lattice using the Heisenberg spin
model (adopt periodic boundary condition). Estimate the ferromagnetic Curie temperature.
\[
    H = -J \sum_{\langle i,j \rangle} \vec{S}_i \cdot \vec{S}_j, \quad J = 1, \quad |\vec{S}_i| = 1
\]

\subsection{ç¨‹åºæè¿°}
æœ¬ç¨‹åºä¸­ï¼Œæˆ‘ä»¬é€šè¿‡metropolisç®—æ³•æ±‚è§£ä¸‰ç»´fccæ™¶æ ¼ä¸Šçš„æµ·æ£®å ¡æ¨¡å‹,ä¸»è¦æ±‚è§£åŠŸèƒ½åœ¨Heisenbergç±»ä¸­å®ç°ã€‚ç¨‹åºå°†è®¡ç®—å¹¶å¯è§†åŒ–$4\times 4\times 4$ä¸ªåˆåŸºå…ƒèƒä¸Š,$\frac{k_B T}{J}=1.0,6.0$æ—¶çš„å¹³è¡¡æ„å‹ã€‚å¹¶åœ¨ä¸åŒå°ºå¯¸ä¸‹($L\times L\times L,L=2,3,4,5$)æ±‚è§£$<E>$,$<M>$,$<C>$,$<\chi>$éšæ¸©åº¦å˜åŒ–çš„å…³ç³»ï¼Œä»¥å¾—åˆ°ç›¸å˜æ¸©åº¦ã€‚

å…¶ä¸­ï¼Œçƒ­å®¹$C$å’Œç£åŒ–ç‡$\chi$å°†é€šè¿‡é‡‡æ ·ç³»ç»Ÿèƒ½é‡å’Œç£çŸ©çš„æ¶¨è½å¾—åˆ°:
\[
    C = \frac{<E^2>-<E>^2}{N k_B T^2},\quad \chi = \frac{<M^2>-<M>^2}{N k_B T}
\]
ç¨‹åºå°†é¦–å…ˆä½¿ç”¨$1000 L^3$ä¸ªMCæ­¥è¿›è¡Œçƒ­å¹³è¡¡ï¼Œç„¶ååœ¨å¹³è¡¡æ„å‹ä¸‹è¿è¡Œ$2000 L^3$ä¸ªMCæ­¥ï¼Œæ¯$L^3$æ­¥é‡‡æ ·ä½“ç³»çš„èƒ½é‡å’Œå¹³å‡ç£çŸ©ã€‚ä¸ºäº†é¿å…ç£ç•´äº§ç”Ÿè€Œéš¾ä»¥è¾¾åˆ°å¹³è¡¡ï¼Œç³»ç»Ÿå°†ä»$\vec{S_i}=(1,0,0)$çš„åŸºæ€æ„å‹å¼€å§‹ã€‚

ç”±äºç³»ç»Ÿå°ºå¯¸$L \to \infty$æ—¶ï¼Œ$\chi$å°†åœ¨$T_c$å¤„å‘æ•£ï¼Œå› æ­¤æˆ‘ä»¬å°†å–$\chi$æœ€å¤§æ—¶çš„æ¸©åº¦ä½œä¸ºä½“ç³»ç›¸å˜æ¸©åº¦ã€‚

æœ¬ç¨‹åºå°†ä½¿ç”¨Marsagliaç®—æ³•ç”Ÿæˆçƒé¢ä¸Šçš„å‡åŒ€åˆ†å¸ƒã€‚

æœ¬ç¨‹åºæºæ–‡ä»¶ä¸ºHeisenberg.pyï¼Œåœ¨ç»ˆç«¯è¿›å…¥å½“å‰ç›®å½•ï¼Œä½¿ç”¨å‘½ä»¤python -u Heisenberg.pyè¿è¡Œæœ¬ç¨‹åºã€‚è¿è¡Œæ—¶è¯·ä¿è¯Pythonç¬¬ä¸‰æ–¹åº“Numpy,Numba,Matplotlibå·²å®‰è£…ã€‚ç¨‹åºå¼€å‘ç¯å¢ƒä¸ºPython3.12.3ï¼Œå¯åœ¨Python3.8ä»¥ä¸Šç‰ˆæœ¬ä¸­è¿è¡Œã€‚


\subsection{ä¼ªä»£ç }
\subsubsection*{Marsagliaç®—æ³•ç”Ÿæˆçƒé¢å‡åŒ€åˆ†å¸ƒ}
\begin{breakablealgorithm}
  \caption{Marsaglia}
  \begin{algorithmic}
    \Function{Marsaglia}{}
      \State \textbf{INPUT:} None
      \State \textbf{OUTPUT:} $result$ (array of three numbers generated using Marsaglia method)
  
      \While{True}
          \State $v1 \gets 2 \cdot$ Random() $- 1$
          \State $v2 \gets 2 \cdot$ Random() $- 1$
          \State $s \gets v1^2 + v2^2$
          \State $s2 \gets \sqrt{1 - s}$
          \If{$s < 1$}
              \State \Return $\text{Array}([2 \cdot v1 \cdot s2, 2 \cdot v2 \cdot s2, 1 - 2 \cdot s])$
          \EndIf
      \EndWhile
    \EndFunction
  \end{algorithmic}
  \end{breakablealgorithm}
  \subsubsection*{æ±‚è§£Heisenbergæ¨¡å‹}
  \begin{breakablealgorithm}
    \caption{Heisenberg Class}
    \begin{algorithmic}
    \State \textbf{Class: Heisenberg}
        \State \textbf{Attributes:}
            \State $L$: Lattice size (integer)
            \State $T$: Temperature (float)
            \State $J$: Interaction constant (default = $-1.0$)
            \State $baiss$: Array defining lattice basis
            \State $lattice$: FCC lattice positions
            \State $spins$: Spin vectors at lattice sites
            \State $neighbors$: List of neighbor indices for each lattice site
        
        \State \textbf{Methods:}
    
        \Function{Init}{$L$, $T$, $J = -1.0$}
            \State $self.L \gets L$, $self.T \gets T$, $self.J \gets J$
            \State $self.baiss \gets \text{Array}([[0, 0, 0], [0, 0.5, 0.5], [0.5, 0, 0.5], [0.5, 0.5, 0]])$
            \State \Call{GenerateFCCLattice}{}
            \State \Call{SetSpins}{}
            \State \Call{InitializeNeighbors}{}
        \EndFunction
    
        \Function{GenerateFCCLattice}{}
            \State $lattice \gets \text{Empty List}$
            \For{$i \gets 0$ to $L - 1$}
                \For{$j \gets 0$ to $L - 1$}
                    \For{$k \gets 0$ to $L - 1$}
                        \For{$b$ in $self.baiss$}
                            \State Append $[i, j, k] + b$ to $lattice$
                        \EndFor
                    \EndFor
                \EndFor
            \EndFor
            \State $self.lattice \gets \text{Array}(lattice)$
        \EndFunction
    
        \Function{InitializeNeighbors}{}
            \State $neighbors \gets \text{Empty List}$
            \State $nbDistance \gets \text{Array}([[0, 0.5, 0.5], [0.5, 0, 0.5], [0.5, 0.5, 0]])$,$tol \gets 10^{-5}$
            \For{$i, r_i$ in $\text{Enumerate}(self.lattice)$}
                \State $neighbor \gets \text{Empty List}$
                \For{$j, r_j$ in $\text{Enumerate}(self.lattice)$}
                    \State $r_{ij} \gets r_i - r_j$
                    \State \Call{ApplyPBC}{$r_{ij}$}
                    \If{$i \neq j$ \textbf{and} $abs(r_{ij})$ is close to any $nbDistance$ within $tol$}
                        \State Append $j$ to $neighbor$
                    \EndIf
                \EndFor
                \State Append $neighbor$ to $neighbors$
            \EndFor
            \State $self.neighbors \gets \text{Array}(neighbors)$
        \EndFunction
    
        \Function{ApplyPBC}{$r_{ij}$}
            \For{$i \gets 0$ to $2$}
                \If{$r_{ij}[i] > L / 2$}
                    \State $r_{ij}[i] \gets r_{ij}[i] - L$
                \ElsIf{$r_{ij}[i] < -L / 2$}
                    \State $r_{ij}[i] \gets r_{ij}[i] + L$
                \EndIf
            \EndFor
        \EndFunction
    
        \Function{CalculateEnergy}{}
            \State $s_n \gets \text{self.spins[self.neighbors]}$
            \State \Return $J \cdot \text{Sum}(\text{self.spins[:, None, :]} \cdot s_n) / 2 / \text{Length(self.lattice)}$
        \EndFunction
    
        \Function{CalculateMagnetization}{}
            \State \Return $\text{Sum}(self.spins, \text{axis} = 0) / \text{Length}(self.lattice)$
        \EndFunction
    
        \Function{CalculateDeltaE}{$i, spin1, spin2$}
            \State $dS \gets spin2 - spin1$
            \State $dE \gets J \cdot \text{Sum}(dS \cdot \text{self.spins[self.neighbors[i]]})$
            \State \Return $dE$
        \EndFunction
    
        \Function{MetropolisStep}{}
            \State $index \gets \text{Random Integer in Range}(\text{Length}(self.spins))$
            \State $spin1 \gets self.spins[index]$
            \State $spin2 \gets \text{Marsaglia()}$
            \State $dE \gets \Call{CalculateDeltaE}{index, spin1, spin2}$
            \If{$dE < 0$ \textbf{or} $\text{Random()} < \exp(-dE / T)$}
                \State $self.spins[index] \gets spin2$
            \EndIf
        \EndFunction
    \end{algorithmic}
    \end{breakablealgorithm}
    
\subsection{è¾“å…¥è¾“å‡ºå®ä¾‹}
å¯¹äºæœ¬ç¨‹åºï¼Œè¿è¡Œåä¼šç”Ÿæˆå›¾\ref{fig:mar},\ref{fig:t1},\ref{fig:t6},\ref{fig:Tc}ä¸º"Marsaglia.png","T=1.0.png","T=6.0.png","fingTc.png"äºå½“å‰ç›®å½•ä¸‹,åˆ†åˆ«ä¸ºçƒé¢éšæœºå‘é‡çš„ç”Ÿæˆï¼ŒT=1.0,6.0æ—¶çš„å¹³è¡¡ç»“æ„ï¼Œä¸åŒ$L$,$<E>,<|M|>,C,\chi$éš$T$çš„å˜åŒ–ã€‚ç¨‹åºè¿è¡Œæˆªå›¾å¦‚å›¾\ref{fig:p2}æ‰€ç¤ºã€‚

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä½æ¸©æ—¶ï¼Œç£çŸ©æœå‘å‡ ä¹ä¸€è‡´(å›¾\ref{fig:t1})ï¼Œé«˜æ¸©æ—¶åˆ™å‘ˆç°æ··ä¹±åˆ†å¸ƒ(å›¾\ref{fig:t6})ã€‚

éšç€æ¸©åº¦çš„å‡é«˜ï¼Œ$<|M|>$åœ¨$T_c$é™„è¿‘ä¸‹é™åˆ°0ï¼Œ$<E>$éšæ¸©åº¦çš„å¢åŠ é€Ÿç‡å‡æ…¢ã€‚è€Œ$C$å’Œ$\chi$åœ¨$T_c$é™„è¿‘æœ‰æ˜æ˜¾çš„å³°å€¼ï¼Œä¸”éšç€ç³»ç»Ÿå°ºå¯¸$L$çš„å¢åŠ ï¼Œå³°å€¼å®½åº¦å‡å°ï¼Œå³°å€¼å¢åŠ ï¼Œè¡¨ç°å‡ºæ˜æ˜¾çš„æœ‰é™å°ºå¯¸æ•ˆåº”(å›¾\ref{fig:Tc})ã€‚

æœ€ç»ˆå¾—åˆ°ç›¸å˜æ¸©åº¦çº¦ä¸º:
\[T_c\approx 3.19 \frac{J}{k_B}\]

\begin{figure}[htpb]
    \centering
    \includegraphics[width=0.6\linewidth]{photo/Marsaglia.png}
    \caption{Marsagliaç®—æ³•ç”Ÿæˆçš„çƒé¢å‡åŒ€åˆ†å¸ƒ}
    \label{fig:mar}
  \end{figure}

  \begin{figure}[htpb]
    \centering
    \includegraphics[width=0.6\linewidth]{photo/T=1.0.png}
    \caption{L=4,T=1.0æ—¶çš„å¹³è¡¡ç»“æ„ï¼Œç£çŸ©æœå‘è¾ƒä¸ºæœ‰åº}
    \label{fig:t1}
  \end{figure}
  \begin{figure}[htpb]
    \centering
    \includegraphics[width=0.6\linewidth]{photo/T=6.0.png}
    \caption{L=4,T=6.0æ—¶çš„å¹³è¡¡ç»“æ„ï¼Œç£çŸ©å‘ˆæ··ä¹±åˆ†å¸ƒ}
    \label{fig:t6}
  \end{figure}

  \begin{figure}[ht]
    \centering
    \includegraphics[width=1.0\linewidth]{photo/findTc.png}
    \caption{ä¸åŒ$L$,$<E>,<|M|>,C,\chi$éš$T$çš„å˜åŒ–}
    \label{fig:Tc}
  \end{figure}


  \begin{figure}
    \centering
    \includegraphics[width=0.6\linewidth]{photo/figp2.png}
    \caption{é¢˜ç›®2ç¨‹åºè¿è¡Œæˆªå›¾}
    \label{fig:p2}
  \end{figure}

\end{document}


